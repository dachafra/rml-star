<!DOCTYPE html><html dir="ltr" lang="en"><head>
<meta charset="utf-8">
<meta name="generator" content="ReSpec 26.9.1">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<style>
dfn{cursor:pointer}
.dfn-panel{position:absolute;z-index:35;min-width:300px;max-width:500px;padding:.5em .75em;margin-top:.6em;font:small Helvetica Neue,sans-serif,Droid Sans Fallback;background:#fff;color:#000;box-shadow:0 1em 3em -.4em rgba(0,0,0,.3),0 0 1px 1px rgba(0,0,0,.05);border-radius:2px}
.dfn-panel:not(.docked)>.caret{position:absolute;top:-9px}
.dfn-panel:not(.docked)>.caret::after,.dfn-panel:not(.docked)>.caret::before{content:"";position:absolute;border:10px solid transparent;border-top:0;border-bottom:10px solid #fff;top:0}
.dfn-panel:not(.docked)>.caret::before{border-bottom:9px solid #a2a9b1}
.dfn-panel *{margin:0}
.dfn-panel b{display:block;color:#000;margin-top:.25em}
.dfn-panel ul a[href]{color:#333}
.dfn-panel>div{display:flex}
.dfn-panel a.self-link{font-weight:700;margin-right:auto}
.dfn-panel .marker{padding:.1em;margin-left:.5em;border-radius:.2em;text-align:center;white-space:nowrap;font-size:90%;color:#040b1c}
.dfn-panel .marker.dfn-exported{background:#d1edfd;box-shadow:0 0 0 .125em #1ca5f940}
.dfn-panel .marker.idl-block{background:#8ccbf2;box-shadow:0 0 0 .125em #0670b161}
.dfn-panel a:not(:hover){text-decoration:none!important;border-bottom:none!important}
.dfn-panel a[href]:hover{border-bottom-width:1px}
.dfn-panel ul{padding:0}
.dfn-panel li{margin-left:1em}
.dfn-panel.docked{position:fixed;left:.5em;top:unset;bottom:2em;margin:0 auto;max-width:calc(100vw - .75em * 2 - .5em - .2em * 2);max-height:30vh;overflow:auto}
</style>
    
<title>RML-star</title>
    
    
<link rel="stylesheet" type="text/css" href="./resources/css/extras.css">
    
    
<style type="text/css">

        /* Adapted from R2RML */
        pre { 
            word-wrap:normal
        }
        pre.ex-input,
        pre.ex-mapping, 
        pre.ex-output,
        pre.ex-target,
        pre.ex-access {
            margin-top: 1.5em;
            padding: 1em; 
            font-size: 75%;
        }
        pre.ex-input:before,
        pre.ex-mapping:before,
        pre.ex-output:before, 
        pre.ex-target:before,
        pre.ex-access:before {
            background: white;
            display: block;
            font-family: sans-serif;
            font-size: 90%;
            margin: -1.5em 0 0.5em 0;
            padding: 0.4em 0.4em;
            width: 18em;
        }
        /* Input data example */
        pre.ex-input {
            background: #cee;
        }
        pre.ex-input,
        pre.ex-input:before {
            border: 1px solid #acc;
        }
        pre.ex-input:before {
            content: "Example input data";
        }
        /* RML mapping example */
        pre.ex-mapping {
            background: #eeb;
        }
        pre.ex-mapping,
        pre.ex-mapping:before {
            border: 1px solid #cc9;
        }
        pre.ex-mapping:before {
            content: "Example RML-star mapping";
        }
        /* Output RDF example */
        pre.ex-output {
            background: #cfc;
        }
        pre.ex-output,
        pre.ex-output:before {
            border: 1px solid #aca;
        }
        pre.ex-output:before {
            content: "Example RDF-star";
        }
    
</style>
    
    
    
<script data-goatcounter="https://rml-star.goatcounter.com/count" async="" src="//gc.zgo.at/count.js"></script>
    
<noscript>
        &amp;lt;img src="https://rml-star.goatcounter.com/count?p=/test-noscript"&amp;gt;
    </noscript>

<style id="respec-mainstyle">
@keyframes pop{
0%{transform:scale(1,1)}
25%{transform:scale(1.25,1.25);opacity:.75}
100%{transform:scale(1,1)}
}
.hljs{background:0 0!important}
a abbr,h1 abbr,h2 abbr,h3 abbr,h4 abbr,h5 abbr,h6 abbr{border:none}
dfn{font-weight:700}
a.internalDFN{color:inherit;border-bottom:1px solid #99c;text-decoration:none}
a.externalDFN{color:inherit;border-bottom:1px dotted #ccc;text-decoration:none}
a.bibref{text-decoration:none}
.respec-offending-element:target{animation:pop .25s ease-in-out 0s 1}
.respec-offending-element,a[href].respec-offending-element{text-decoration:red wavy underline}
@supports not (text-decoration:red wavy underline){
.respec-offending-element:not(pre){display:inline-block}
.respec-offending-element{background:url(data:image/gif;base64,R0lGODdhBAADAPEAANv///8AAP///wAAACwAAAAABAADAEACBZQjmIAFADs=) bottom repeat-x}
}
#references :target{background:#eaf3ff;animation:pop .4s ease-in-out 0s 1}
cite .bibref{font-style:normal}
code{color:#c63501}
th code{color:inherit}
a[href].orcid{padding-left:4px;padding-right:4px}
a[href].orcid>svg{margin-bottom:-2px}
.toc a,.tof a{text-decoration:none}
a .figno,a .secno{color:#000}
ol.tof,ul.tof{list-style:none outside none}
.caption{margin-top:.5em;font-style:italic}
table.simple{border-spacing:0;border-collapse:collapse;border-bottom:3px solid #005a9c}
.simple th{background:#005a9c;color:#fff;padding:3px 5px;text-align:left}
.simple th a{color:#fff;padding:3px 5px;text-align:left}
.simple th[scope=row]{background:inherit;color:inherit;border-top:1px solid #ddd}
.simple td{padding:3px 10px;border-top:1px solid #ddd}
.simple tr:nth-child(even){background:#f0f6ff}
.section dd>p:first-child{margin-top:0}
.section dd>p:last-child{margin-bottom:0}
.section dd{margin-bottom:1em}
.section dl.attrs dd,.section dl.eldef dd{margin-bottom:0}
#issue-summary>ul{column-count:2}
#issue-summary li{list-style:none;display:inline-block}
details.respec-tests-details{margin-left:1em;display:inline-block;vertical-align:top}
details.respec-tests-details>*{padding-right:2em}
details.respec-tests-details[open]{z-index:999999;position:absolute;border:thin solid #cad3e2;border-radius:.3em;background-color:#fff;padding-bottom:.5em}
details.respec-tests-details[open]>summary{border-bottom:thin solid #cad3e2;padding-left:1em;margin-bottom:1em;line-height:2em}
details.respec-tests-details>ul{width:100%;margin-top:-.3em}
details.respec-tests-details>li{padding-left:1em}
a[href].self-link:hover{opacity:1;text-decoration:none;background-color:transparent}
h2,h3,h4,h5,h6{position:relative}
aside.example .marker>a.self-link{color:inherit}
h2>a.self-link,h3>a.self-link,h4>a.self-link,h5>a.self-link,h6>a.self-link{border:none;color:inherit;font-size:83%;height:2em;left:-1.6em;opacity:.5;position:absolute;text-align:center;text-decoration:none;top:0;transition:opacity .2s;width:2em}
h2>a.self-link::before,h3>a.self-link::before,h4>a.self-link::before,h5>a.self-link::before,h6>a.self-link::before{content:"ยง";display:block}
@media (max-width:767px){
dd{margin-left:0}
h2>a.self-link,h3>a.self-link,h4>a.self-link,h5>a.self-link,h6>a.self-link{left:auto;top:auto}
}
@media print{
.removeOnSave{display:none}
}
</style>
<meta name="description" content="RML-star is an extension of RML that is designed for generating RDF-star from heterogeneous data. This document describes RML-star through definitions and examples.">
<style>
.hljs{display:block;overflow-x:auto;padding:.5em;color:#383a42;background:#fafafa}
.hljs-comment,.hljs-quote{color:#717277;font-style:italic}
.hljs-doctag,.hljs-formula,.hljs-keyword{color:#a626a4}
.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#ca4706;font-weight:700}
.hljs-literal{color:#0b76c5}
.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#42803c}
.hljs-built_in,.hljs-class .hljs-title{color:#9a6a01}
.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#986801}
.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#336ae3}
.hljs-emphasis{font-style:italic}
.hljs-strong{font-weight:700}
.hljs-link{text-decoration:underline}
</style>
<style>
var{position:relative;cursor:pointer}
var[data-type]::after,var[data-type]::before{position:absolute;left:50%;top:-6px;opacity:0;transition:opacity .4s;pointer-events:none}
var[data-type]::before{content:"";transform:translateX(-50%);border-width:4px 6px 0 6px;border-style:solid;border-color:transparent;border-top-color:#000}
var[data-type]::after{content:attr(data-type);transform:translateX(-50%) translateY(-100%);background:#000;text-align:center;font-family:"Dank Mono","Fira Code",monospace;font-style:normal;padding:6px;border-radius:3px;color:#daca88;text-indent:0;font-weight:400}
var[data-type]:hover::after,var[data-type]:hover::before{opacity:1}
</style>
<script id="initialUserConfig" type="application/json">{
  "localBiblio": {
    "RDF11-Concepts": {
      "title": "RDF 1.1 Concepts and Abstract Syntax",
      "href": "https://www.w3.org/TR/rdf11-concepts/",
      "status": "W3C Recommendation",
      "publisher": "W3C",
      "date": "25 February 2014",
      "id": "rdf11-concepts"
    },
    "Turtle": {
      "title": "RDF 1.1 Turtle",
      "href": "https://www.w3.org/TR/turtle/",
      "status": "W3C Recommendation",
      "publisher": "W3C",
      "date": "25 February 2014",
      "id": "turtle"
    },
    "RDF-star": {
      "title": "RDF-star and SPARQL-star",
      "href": "https://w3c.github.io/rdf-star/cg-spec/",
      "status": "Community Group Draft",
      "publisher": "W3C",
      "date": "13 April 2021",
      "id": "rdf-star"
    },
    "RML": {
      "title": "RDF Mapping Language",
      "href": "https://rml.io/specs/rml/",
      "status": "Unofficial draft",
      "publisher": "https://rml.io",
      "date": "06 October 2020",
      "id": "rml"
    }
  },
  "doRdfa": "true",
  "processVersion": 2021,
  "specStatus": "unofficial",
  "shortName": "rml-star",
  "copyrightStart": "2021",
  "edDraftURI": "https://rml.io/specs/rml-star",
  "editors": [
    {
      "name": "Anastasia Dimou",
      "mailto": "anastasia.dimou@ugent.be",
      "company": "Ghent University &ndash; imec &ndash; IDLab",
      "orcidid": "0000-0003-2138-7972",
      "companyURL": "http://idlab.technology/",
      "url": "mailto:anastasia.dimou@ugent.be"
    }
  ],
  "otherLinks": [
    {
      "key": "This Version",
      "data": [
        {
          "value": "https://rml.io/specs/rml-star/%thisDate%/",
          "href": "https://rml.io/specs/rml-star/%thisDate%/"
        }
      ]
    },
    {
      "key": "Previous Version",
      "data": [
        {
          "value": "https://rml.io/specs/rml-star/%prevDate%/",
          "href": "https://rml.io/specs/rml-star/%prevDate%/"
        }
      ]
    },
    {
      "key": "Website",
      "data": [
        {
          "value": "https://rml.io/",
          "href": "https://rml.io/"
        }
      ]
    }
  ],
  "publishISODate": "2021-06-28T00:00:00.000Z",
  "generatedSubtitle": "Unofficial Draft 28 June 2021"
}</script>
<link rel="stylesheet" href="https://www.w3.org/StyleSheets/TR/2016/W3C-UD"></head>
<body class="h-entry informative"><div class="head">
     <h1 id="title" class="title">RML-star</h1>
    
    <h2>
      Unofficial Draft
      <time class="dt-published" datetime="2021-06-28">28 June 2021</time>
    </h2>
    <dl>
      
      <dt>Latest editor's draft:</dt><dd><a href="https://rml.io/specs/rml-star">https://rml.io/specs/rml-star</a></dd>
      
      
      
      
      
      <dt>Editor:</dt>
      <dd class="editor p-author h-card vcard">
    <a class="ed_mailto u-email email p-name" href="mailto:anastasia.dimou@ugent.be">Anastasia Dimou</a> (<a class="p-org org h-org" href="http://idlab.technology/">Ghent University โ imec โ IDLab</a>)
  </dd>
      
      
      <dt>This Version</dt><dd>
    <a href="https://rml.io/specs/rml-star/%thisDate%/">https://rml.io/specs/rml-star/%thisDate%/</a>
  </dd><dt>Previous Version</dt><dd>
    <a href="https://rml.io/specs/rml-star/%prevDate%/">https://rml.io/specs/rml-star/%prevDate%/</a>
  </dd><dt>Website</dt><dd>
    <a href="https://rml.io/">https://rml.io/</a>
  </dd>
    </dl>
    
    
    
    <p class="copyright">
      This document is licensed under a
      <a rel="license" href="https://creativecommons.org/licenses/by/4.0/legalcode" class="subfoot">Creative Commons Attribution 4.0 International Public License</a>
      (CC-BY).
    </p>
    <hr title="Separator for header">
  </div>
<section id="abstract" class="introductory"><h2 id="abstract">Abstract</h2><p>RML-star is an extension of RML that is designed for generating RDF-star from heterogeneous data. This document describes RML-star through definitions and examples.</p><p>The version of this document is <em>Unreleased</em>.</p></section>

<section id="sotd" class="introductory"><h2>Status of This Document</h2><p>
      This document is a draft of a potential specification. It has no official
      standing of any kind and does not represent the support or consensus of
      any standards organization.
    </p>
    <p data-format="markdown"><p>This is an early draft,
yet efforts are made to keep things stable.</p></p>
</section><nav id="toc"><h2 class="introductory" id="table-of-contents">Table of Contents</h2><ol class="toc"><li class="tocline"><a class="tocxref" href="#overview"><bdi class="secno">1. </bdi>Overview</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#conformance"><bdi class="secno">1.1 </bdi>Conformance</a></li><li class="tocline"><a class="tocxref" href="#conventions"><bdi class="secno">1.2 </bdi>Document conventions</a></li></ol></li><li class="tocline"><a class="tocxref" href="#vocabulary"><bdi class="secno">2. </bdi>The RML-star vocabulary</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#overview-of-rml-star-terms"><bdi class="secno">2.1 </bdi>Overview of RML-star terms</a></li></ol></li><li class="tocline"><a class="tocxref" href="#embedded"><bdi class="secno">3. </bdi>Generating embedded triples with RML-star</a></li><li class="tocline"><a class="tocxref" href="#join"><bdi class="secno">4. </bdi>Generating embedded triples from multiple sources</a></li><li class="tocline"><a class="tocxref" href="#references"><bdi class="secno">A. </bdi>References</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#informative-references"><bdi class="secno">A.1 </bdi>Informative references</a></li></ol></li></ol></nav>

<section id="overview-0"><h2 id="overview"><bdi class="secno">1. </bdi>Overview<a class="self-link" aria-label="ยง" href="#overview"></a></h2><p><em>This section is non-normative.</em></p><p>RDF-star [<cite><a class="bibref" data-link-type="biblio" href="#bib-rdf-star" title="RDF-star and SPARQL-star">RDF-star</a></cite>] is an extension of the Resource Description Framework (RDF) [<cite><a class="bibref" data-link-type="biblio" href="#bib-rdf11-concepts" title="RDF 1.1 Concepts and Abstract Syntax">RDF11-Concepts</a></cite>]. RDF covers triples that are built from three terms: subject, predicate and object, and each term is either an IRI, a blank node or a literal. RDF-star adds a fourth kind of term: the RDF-star triple. With RDF-star, it is possible to represent metadata about individual triples.</p><pre class="ex-output" aria-busy="false"><code class="hljs"># This RDF-star example says that the triple ( :Alice a :Person ) is 80% likely to be true
&lt;&lt; :Alice a :Person &gt;&gt; :confidence 0.8 .</code></pre><p>The RDF Mapping Language (RML) [<cite><a class="bibref" data-link-type="biblio" href="#bib-rml" title="RDF Mapping Language">RML</a></cite>] is a language for expressing mappings between heterogeneous data and RDF. In RML, rules can be expressed to iterate over a data source and refer to specific data within an iteration. Using these iterators and references, RML rules define how to express data in the data source in RDF.</p><p>This document describes RML-star: an extension of RML that adds the generation of RDF-star triples to RML. </p><section id="conformance-0"><h3 id="conformance"><bdi class="secno">1.1 </bdi>Conformance<a class="self-link" aria-label="ยง" href="#conformance"></a></h3><p>As well as sections marked as non-normative, all authoring guidelines, diagrams, examples, and notes in this specification are non-normative. Everything else in this specification is normative.</p></section><section id="document-conventions"><h3 id="conventions"><bdi class="secno">1.2 </bdi>Document conventions<a class="self-link" aria-label="ยง" href="#conventions"></a></h3><p>We assume readers have basic familiarity with RDF, RML and RDF-star concepts.</p><p>In this document, examples assume 
the following namespace prefix bindings unless otherwise stated:</p><table>
<thead>
<tr>
<th>Prefix</th>
<th>Namespace</th>
</tr>
</thead>
<tbody><tr>
<td><code>rml:</code></td>
<td><a href="http://semweb.mmlab.be/ns/rml#">http://semweb.mmlab.be/ns/rml#</a></td>
</tr>
<tr>
<td><code>rr:</code></td>
<td><a href="http://www.w3.org/ns/r2rml#">http://www.w3.org/ns/r2rml#</a></td>
</tr>
<tr>
<td><code>xsd:</code></td>
<td><a href="http://www.w3.org/2001/XMLSchema#">http://www.w3.org/2001/XMLSchema#</a></td>
</tr>
<tr>
<td><code>ex:</code></td>
<td><a href="http://example.org/">http://example.org/</a></td>
</tr>
<tr>
<td><code>:</code></td>
<td><a href="http://example.org/">http://example.org/</a></td>
</tr>
</tbody></table><p>The examples are contained in color-coded boxes. We use the Turtle syntax [<cite><a class="bibref" data-link-type="biblio" href="#bib-turtle" title="RDF 1.1 Turtle">Turtle</a></cite>] to write RDF and the Turtle-star syntax [<cite><a class="bibref" data-link-type="biblio" href="#bib-rdf-star" title="RDF-star and SPARQL-star">RDF-star</a></cite>] to write RDF-star.</p><pre class="ex-input" aria-busy="false"><code class="hljs"># This box contains an example input</code></pre><pre class="ex-mapping" aria-busy="false"><code class="hljs"># This box contains an example mapping</code></pre><pre class="ex-output" aria-busy="false"><code class="hljs"># This box contains the example output</code></pre></section></section>

<section id="the-rml-star-vocabulary"><h2 id="vocabulary"><bdi class="secno">2. </bdi>The RML-star vocabulary<a class="self-link" aria-label="ยง" href="#vocabulary"></a></h2><p>RML-star extends the RML vocabulary by introducing three new terms: </p><ul>
<li><code>rml:embeddedTriplesMap</code> is a new property that connects a term map with a triples map. It indicates the term map will generate embedded triples generated by the triples map.</li>
<li><code>rml:StarMap</code> is a new kind of term map that is used to generate embedded triples. Conforming to the RDF-star specification, it can be used to generate subjects and objects. This class is the domain of <code>rml:embeddedTriplesMap</code>.</li>
<li><code>rml:EmbeddedTriplesMap</code> is a new kind of triples map that indicates a triples map <em>only</em> creates embedded triples, instead of also creating asserted triples. Creating asserted triples is the default for RML triples maps.</li>
</ul><section id="overview-of-rml-star-terms"><h3 id="x2-1-overview-of-rml-star-terms"><bdi class="secno">2.1 </bdi>Overview of RML-star terms<a class="self-link" aria-label="ยง" href="#overview-of-rml-star-terms"></a></h3><p>The new terms are summarized in the following tables.</p><table>
<thead>
<tr>
<th>Property</th>
<th>Domain</th>
<th>Range</th>
<th>Cardinality</th>
</tr>
</thead>
<tbody><tr>
<td><code>rml:embeddedTriplesMap</code></td>
<td><code>rr:StarMap</code></td>
<td><code>rml:TriplesMap</code></td>
<td>1</td>
</tr>
</tbody></table><table>
<thead>
<tr>
<th>Class</th>
<th>Superclass</th>
</tr>
</thead>
<tbody><tr>
<td><code>rml:StarMap</code></td>
<td><code>rr:TermMap</code></td>
</tr>
<tr>
<td><code>rml:EmbeddedTriplesMap</code></td>
<td><code>rr:TriplesMap</code></td>
</tr>
</tbody></table><p>To accomodate the new terms we introduce, certain domains and ranges of RML properties need to be changed. We summarize them in the following table.</p><table>
<thead>
<tr>
<th>Property</th>
<th>Change</th>
<th>Old</th>
<th>New</th>
</tr>
</thead>
<tbody><tr>
<td><code>rr:subjectMap</code></td>
<td>Range</td>
<td><code>rr:SubjectMap</code></td>
<td>Union of <code>rr:SubjectMap</code>, <code>rml:StarMap</code></td>
</tr>
<tr>
<td><code>rr:objectMap</code></td>
<td>Range</td>
<td>Union of <code>rr:ObjectMap</code>, <code>rr:RefObjMap</code></td>
<td>Union of <code>rr:ObjectMap</code>, <code>rr:RefObjMap</code>, <code>rml:StarMap</code></td>
</tr>
<tr>
<td><code>rr:joinCondition</code></td>
<td>Domain</td>
<td><code>rr:RefObjMap</code></td>
<td>Union of <code>rr:RefObjMap</code>, <code>rml:StarMap</code></td>
</tr>
</tbody></table></section></section>

<section id="generating-embedded-triples-with-rml-star"><h2 id="embedded"><bdi class="secno">3. </bdi>Generating embedded triples with RML-star<a class="self-link" aria-label="ยง" href="#embedded"></a></h2><p>A <dfn id="dfn-star-map" tabindex="0" aria-haspopup="dialog">star map</dfn> (<code>rml:StarMap</code>) is a <a href="https://rml.io/specs/rml/#term-map">term map</a> that generates <a href="https://w3c.github.io/rdf-star/cg-spec/2021-04-13.html#dfn-embedded">embedded triples</a>.
It can be used in the subject map and object map positions.
A star map has exactly one <a href="https://rml.io/specs/rml/#triples-map">triples map</a> it is linked to by the <dfn id="dfn-embedded-triples-map-property" tabindex="0" aria-haspopup="dialog">embedded triples map property</dfn> (<code>rml:embeddedTriplesMap</code>). 
The embedded triples generated by a <a data-link-type="dfn" href="#dfn-star-map" class="internalDFN" id="ref-for-dfn-star-map-1">star map</a> are exactly those triples generated by its triples map.
If a star map has the same <a href="https://rml.io/specs/rml/#logical-source">logical source</a> as its triples map then for each <a href="https://rml.io/specs/rml/#iterator">logical iteration</a> the embedded triples generated by a star map are those triples generated by its triples map <em>for the same logical iteration</em>.
If a star map has a different logical source than its triples map then a join is used, as described in <a href="#join">the next section</a>.</p><p>In the following example, per logical iteration, i.e., per CSV row, a "type" triple is generated by <code>:innerTriplesMap</code> that occurs 
in the resulting graph both as an asserted and as an embedded triple: </p><pre class="ex-input" aria-busy="false"><code class="hljs">entity,class,confidence
Alice,Person,0.8
Bobby,Dog,0.6</code></pre><pre class="ex-mapping nohighlight">
# logical source that will iterate over the CSV file
:CSVLogicalSource a rml:LogicalSource ;
  rml:source :CSVFile ;
  rml:referenceFormulation ql:CSV .

# triples map that generates "type" triples
:innerTriplesMap a rr:TriplesMap ;
  rml:logicalSource :CSVLogicalSource ;
  rr:subjectMap [ rr:template "http://example.com/{entity}" ] ;
  rr:predicateObjectMap [
    rr:predicate rdf:type ;
    rr:objectMap [ rr:template "http://example.com/{class}" ] ] .
    
# triples map that generates "confidence" triples
:outerTriplesMap a rr:TriplesMap ;
  rml:logicalSource [ 
    rml:source :CSVLogicalSource ;
  rr:subjectMap [ <b>rml:embeddedTriplesMap :innerTriplesMap</b> ] ;
  rr:predicateObjectMap [
    rr:predicate :confidence ;
    rr:objectMap [ 
      rml:reference "confidence" ;
      rr:termType xsd:float ] ] .</pre><pre class="ex-output" aria-busy="false"><code class="hljs"># Triples generated by :innerTriplesMap
:Alice a :Person .
:Bobby a :Dog .

# Triples generated by :outerTriplesMap
&lt;&lt; :Alice a :Person &gt;&gt; :confidence 0.8 .
&lt;&lt; :Bobby a :Dog &gt;&gt; :confidence 0.6 .</code></pre><p>By default, triples generated by a triples map are generated as <a href="https://w3c.github.io/rdf-star/cg-spec/2021-04-13.html#dfn-asserted">asserted triples</a>.
If the triples map is also used in a <a data-link-type="dfn" href="#dfn-star-map" class="internalDFN" id="ref-for-dfn-star-map-2">star map</a>, the triples it generates <em>also</em> occur in the resulting graph as embedded triples, by the process explained in the previous paragraph.
The generation of asserted triples by a triples map can be supressed by declaring it an <dfn id="dfn-embedded-triples-map" tabindex="0" aria-haspopup="dialog">embedded triples map</dfn> (<code>rml:EmbeddedTriplesMap</code>).
A triples map of subclass embedded triples map generates embedded triples, but not asserted triples.
A summary of how to generate triples in any combination of asserted and/or embedded is given in the following table:</p><table>
<thead>
<tr>
<th><nop></nop></th>
<th>Embedded</th>
<th>Not embedded</th>
</tr>
</thead>
<tbody><tr>
<td><strong>Asserted</strong></td>
<td><code>rml:StarMap</code> <em>without</em> <code>rml:EmbeddedTriplesMap</code></td>
<td><code>rr:TriplesMap</code> <em>without</em> <code>rml:StarMap</code></td>
</tr>
<tr>
<td><strong>Not asserted</strong></td>
<td><code>rml:StarMap</code> <em>with</em> <code>rml:EmbeddedTriplesMap</code></td>
<td>--</td>
</tr>
</tbody></table><p>The following example is different than the previous in that <code>:innerTriplesMap</code> is declared to be an instance of <code>rml:EmbeddedTriplesMap</code>, with the effect that the generated "type" triples are only present in the resulting graph as embedded triples, not as asserted triples:</p><pre class="ex-input" aria-busy="false"><code class="hljs">entity,class,confidence
Alice,Person,0.8
Bobby,Dog,0.6</code></pre><pre class="ex-mapping nohighlight">
# logical source that will iterate over the CSV file
:CSVLogicalSource a rml:LogicalSource ;
  rml:source :CSVFile ;
  rml:referenceFormulation ql:CSV .

# triples map that generates "type" triples
:innerTriplesMap <b>a rml:EmbeddedTriplesMap</b> ;
  rml:logicalSource :CSVLogicalSource ;
  rr:subjectMap [ rr:template "http://example.com/{entity}" ] ;
  rr:predicateObjectMap [
    rr:predicate rdf:type ;
    rr:objectMap [ rr:template "http://example.com/{class}" ] ] .
    
# triples map that generates "confidence" triples
:outerTriplesMap a rr:TriplesMap ;
  rml:logicalSource [ 
    rml:source :CSVLogicalSource ;
  rr:subjectMap [ rml:embeddedTriplesMap :innerTriplesMap ] ;
  rr:predicateObjectMap [
    rr:predicate :confidence ;
    rr:objectMap [ 
      rml:reference "confidence" ;
      rr:termType xsd:float ] ] .</pre><pre class="ex-output" aria-busy="false"><code class="hljs">&lt;&lt; :Alice a :Person &gt;&gt; :confidence 0.8 .
&lt;&lt; :Bobby a :Dog &gt;&gt; :confidence 0.6 .</code></pre></section>

<section id="generating-embedded-triples-from-multiple-sources"><h2 id="join"><bdi class="secno">4. </bdi>Generating embedded triples from multiple sources<a class="self-link" aria-label="ยง" href="#join"></a></h2></section>



<section id="references" class="appendix"><h2 id="a-references"><bdi class="secno">A. </bdi>References<a class="self-link" aria-label="ยง" href="#references"></a></h2><section id="informative-references">
    <h3 id="a-1-informative-references"><bdi class="secno">A.1 </bdi>Informative references<a class="self-link" aria-label="ยง" href="#informative-references"></a></h3>
    <dl class="bibliography"><dt id="bib-rdf-star">[RDF-star]</dt><dd><a href="https://w3c.github.io/rdf-star/cg-spec/"><cite>RDF-star and SPARQL-star</cite></a>.  W3C. 13 April 2021. Community Group Draft. URL: <a href="https://w3c.github.io/rdf-star/cg-spec/">https://w3c.github.io/rdf-star/cg-spec/</a></dd><dt id="bib-rdf11-concepts">[RDF11-Concepts]</dt><dd><a href="https://www.w3.org/TR/rdf11-concepts/"><cite>RDF 1.1 Concepts and Abstract Syntax</cite></a>.  W3C. 25 February 2014. W3C Recommendation. URL: <a href="https://www.w3.org/TR/rdf11-concepts/">https://www.w3.org/TR/rdf11-concepts/</a></dd><dt id="bib-rml">[RML]</dt><dd><a href="https://rml.io/specs/rml/"><cite>RDF Mapping Language</cite></a>.  https://rml.io. 06 October 2020. Unofficial draft. URL: <a href="https://rml.io/specs/rml/">https://rml.io/specs/rml/</a></dd><dt id="bib-turtle">[Turtle]</dt><dd><a href="https://www.w3.org/TR/turtle/"><cite>RDF 1.1 Turtle</cite></a>.  W3C. 25 February 2014. W3C Recommendation. URL: <a href="https://www.w3.org/TR/turtle/">https://www.w3.org/TR/turtle/</a></dd></dl>
  </section></section><p role="navigation" id="back-to-top">
    <a href="#title"><abbr title="Back to Top">โ</abbr></a>
  </p><div class="dfn-panel" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-star-map" aria-label="Links in this document to definition: star map" hidden="">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-star-map" aria-label="Permalink for definition: star map. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-star-map-1" title="ยง 3. Generating embedded triples with RML-star">ยง 3. Generating embedded triples with RML-star</a> <a href="#ref-for-dfn-star-map-2" title="Reference 2">(2)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-embedded-triples-map-property" aria-label="Links in this document to definition: embedded triples map property" hidden="">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-embedded-triples-map-property" aria-label="Permalink for definition: embedded triples map property. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-embedded-triples-map" aria-label="Links in this document to definition: embedded triples map" hidden="">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-embedded-triples-map" aria-label="Permalink for definition: embedded triples map. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><script id="respec-dfn-panel">(() => {
// @ts-check
if (document.respec) {
  document.respec.ready.then(setupPanel);
} else {
  setupPanel();
}

function setupPanel() {
  const listener = panelListener();
  document.body.addEventListener("keydown", listener);
  document.body.addEventListener("click", listener);
}

function panelListener() {
  /** @type {HTMLElement} */
  let panel = null;
  return event => {
    const { target, type } = event;

    if (!(target instanceof HTMLElement)) return;

    // For keys, we only care about Enter key to activate the panel
    // otherwise it's activated via a click.
    if (type === "keydown" && event.key !== "Enter") return;

    const action = deriveAction(event);

    switch (action) {
      case "show": {
        hidePanel(panel);
        /** @type {HTMLElement} */
        const dfn = target.closest("dfn, .index-term");
        panel = document.getElementById(`dfn-panel-for-${dfn.id}`);
        const coords = deriveCoordinates(event);
        displayPanel(dfn, panel, coords);
        break;
      }
      case "dock": {
        panel.style.left = null;
        panel.style.top = null;
        panel.classList.add("docked");
        break;
      }
      case "hide": {
        hidePanel(panel);
        panel = null;
        break;
      }
    }
  };
}

/**
 * @param {MouseEvent|KeyboardEvent} event
 */
function deriveCoordinates(event) {
  const target = /** @type HTMLElement */ (event.target);

  // We prevent synthetic AT clicks from putting
  // the dialog in a weird place. The AT events sometimes
  // lack coordinates, so they have clientX/Y = 0
  const rect = target.getBoundingClientRect();
  if (
    event instanceof MouseEvent &&
    event.clientX >= rect.left &&
    event.clientY >= rect.top
  ) {
    // The event probably happened inside the bounding rect...
    return { x: event.clientX, y: event.clientY };
  }

  // Offset to the middle of the element
  const x = rect.x + rect.width / 2;
  // Placed at the bottom of the element
  const y = rect.y + rect.height;
  return { x, y };
}

/**
 * @param {Event} event
 */
function deriveAction(event) {
  const target = /** @type {HTMLElement} */ (event.target);
  const hitALink = !!target.closest("a");
  if (target.closest("dfn:not([data-cite]), .index-term")) {
    return hitALink ? "none" : "show";
  }
  if (target.closest(".dfn-panel")) {
    if (hitALink) {
      return target.classList.contains("self-link") ? "hide" : "dock";
    }
    const panel = target.closest(".dfn-panel");
    return panel.classList.contains("docked") ? "hide" : "none";
  }
  if (document.querySelector(".dfn-panel:not([hidden])")) {
    return "hide";
  }
  return "none";
}

/**
 * @param {HTMLElement} dfn
 * @param {HTMLElement} panel
 * @param {{ x: number, y: number }} clickPosition
 */
function displayPanel(dfn, panel, { x, y }) {
  panel.hidden = false;
  // distance (px) between edge of panel and the pointing triangle (caret)
  const MARGIN = 20;

  const dfnRects = dfn.getClientRects();
  // Find the `top` offset when the `dfn` can be spread across multiple lines
  let closestTop = 0;
  let minDiff = Infinity;
  for (const rect of dfnRects) {
    const { top, bottom } = rect;
    const diffFromClickY = Math.abs((top + bottom) / 2 - y);
    if (diffFromClickY < minDiff) {
      minDiff = diffFromClickY;
      closestTop = top;
    }
  }

  const top = window.scrollY + closestTop + dfnRects[0].height;
  const left = x - MARGIN;
  panel.style.left = `${left}px`;
  panel.style.top = `${top}px`;

  // Find if the panel is flowing out of the window
  const panelRect = panel.getBoundingClientRect();
  const SCREEN_WIDTH = Math.min(window.innerWidth, window.screen.width);
  if (panelRect.right > SCREEN_WIDTH) {
    const newLeft = Math.max(MARGIN, x + MARGIN - panelRect.width);
    const newCaretOffset = left - newLeft;
    panel.style.left = `${newLeft}px`;
    /** @type {HTMLElement} */
    const caret = panel.querySelector(".caret");
    caret.style.left = `${newCaretOffset}px`;
  }

  // As it's a dialog, we trap focus.
  // TODO: when <dialog> becomes a implemented, we should really
  // use that.
  trapFocus(panel, dfn);
}

/**
 * @param {HTMLElement} panel
 * @param {HTMLElement} dfn
 * @returns
 */
function trapFocus(panel, dfn) {
  /** @type NodeListOf<HTMLAnchorElement> elements */
  const anchors = panel.querySelectorAll("a[href]");
  // No need to trap focus
  if (!anchors.length) return;

  // Move focus to first anchor element
  const first = anchors.item(0);
  first.focus();

  const trapListener = createTrapListener(anchors, panel, dfn);
  panel.addEventListener("keydown", trapListener);

  // Hiding the panel releases the trap
  const mo = new MutationObserver(records => {
    const [record] = records;
    const target = /** @type HTMLElement */ (record.target);
    if (target.hidden) {
      panel.removeEventListener("keydown", trapListener);
      mo.disconnect();
    }
  });
  mo.observe(panel, { attributes: true, attributeFilter: ["hidden"] });
}

/**
 *
 * @param {NodeListOf<HTMLAnchorElement>} anchors
 * @param {HTMLElement} panel
 * @param {HTMLElement} dfn
 * @returns
 */
function createTrapListener(anchors, panel, dfn) {
  const lastIndex = anchors.length - 1;
  let currentIndex = 0;
  return event => {
    switch (event.key) {
      // Hitting "Tab" traps us in a nice loop around elements.
      case "Tab": {
        event.preventDefault();
        currentIndex += event.shiftKey ? -1 : +1;
        if (currentIndex < 0) {
          currentIndex = lastIndex;
        } else if (currentIndex > lastIndex) {
          currentIndex = 0;
        }
        anchors.item(currentIndex).focus();
        break;
      }

      // Hitting "Enter" on an anchor releases the trap.
      case "Enter":
        hidePanel(panel);
        break;

      // Hitting "Escape" returns focus to dfn.
      case "Escape":
        hidePanel(panel);
        dfn.focus();
        return;
    }
  };
}

/** @param {HTMLElement} panel */
function hidePanel(panel) {
  if (!panel) return;
  panel.hidden = true;
  panel.classList.remove("docked");
}
})()</script><script src="https://www.w3.org/scripts/TR/2016/fixup.js"></script></body></html>