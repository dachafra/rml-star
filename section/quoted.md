## Generating quoted triples with RML-star {#quoted}

A <dfn>star map</dfn> (`rml:StarMap`) is similar to a [term map](https://rml.io/specs/rml/#term-map) that generates [=quoted triples=].
It can be used within subject and object maps.
A star map is linked to a [triples map](https://rml.io/specs/rml/#triples-map) by the <dfn>quoted triples map</dfn> property (`rml:quotedTriplesMap`).
The [=quoted triples=] generated by a [=star map=] are exactly those triples generated by its [=quoted triples map=].
If a star map has the same [logical source](https://rml.io/specs/rml/#logical-source) as its [=quoted triples map=], then for each [logical iteration](https://rml.io/specs/rml/#iterator), the [=quoted triples=] generated by a star map are those triples generated by its [=quoted triples map=] *for the same logical iteration*.
If a star map has a different logical source than its quoted triples map then a join is used, as described in [the next section](#join).

In the following example, for each logical iteration (i.e., each CSV row) a "type" triple is generated by `<#innerTriplesMap>` that occurs
in the resulting graph both as an asserted and as an quoted triple:

<pre class="ex-input">
# contents of the ex:ConfidenceSource logical source
entity,class,confidence
Alice,Person,0.8
Bobby,Dog,0.6
</pre>

<pre class="ex-mapping nohighlight"><!-- nohighlight because otherwise the bolding is lost and we don't use highlighting anyway-->
# triples map that generates "type" triples
<#innerTriplesMap>
  a rr:TriplesMap ;
  rml:logicalSource ex:ConfidenceSource ;
  rml:subjectMap [
    rr:template "http://example.com/{entity}"
  ] ;
  rr:predicateObjectMap [
    rr:predicate rdf:type ;
    rml:objectMap [ rr:template "http://example.com/{class}" ]
  ] .

# triples map that generates "confidence" triples
<#outerTriplesMap>
  a rr:TriplesMap ;
  rml:logicalSource ex:ConfidenceSource ;
  rml:subjectMap [
    <b>rml:quotedTriplesMap <#innerTriplesMap></b>
  ] ;
  rr:predicateObjectMap [
    rr:predicate ex:confidence ;
    rml:objectMap [ rml:reference "confidence"; rr:datatype xsd:float ]
  ] .
</pre>

<pre class="ex-output">
# Triples generated by <#innerTriplesMap>
ex:Alice a ex:Person .
ex:Bobby a ex:Dog .

# Triples generated by <#outerTriplesMap>
<< ex:Alice a ex:Person >> ex:confidence 0.8 .
<< ex:Bobby a ex:Dog >> ex:confidence 0.6 .
</pre>

By default, triples generated by a triples map are generated as [=asserted triples=].
If the triples map is also used in a [=star map=], the triples it generates *also* occur in the resulting graph as [=quoted triples=], by the process explained above.
The generation of asserted triples by a triples map can be supressed by declaring it an <dfn>non-asserted triples map</dfn> (`rml:NonAssertedTriplesMap`),
a subclass of `rr:TriplesMap`.
A triples map of subclass [=non-asserted triples map=] does not generate [=asserted triples=],
but might generate [=quoted triples=] if it is used in a [=star map=].

The following example is different than the previous in that `<#innerTriplesMap>` is declared to be an instance of `rml:NonAssertedTriplesMap`, with the effect that the generated "type" triples are only present in the resulting graph as [=quoted triples=], not as [=asserted triples=]:

<pre class="ex-input">
# contents of the ex:ConfidenceSource logical source
entity,class,confidence
Alice,Person,0.8
Bobby,Dog,0.6
</pre>

<pre class="ex-mapping nohighlight"><!-- nohighlight because otherwise the bolding is lost and we don't use highlighting anyway-->
# triples map that generates "type" triples
<#innerTriplesMap>
  <b>a rml:NonAssertedTriplesMap</b> ;
  rml:logicalSource ex:ConfidenceSource ;
  rml:subjectMap [
    rr:template "http://example.com/{entity}"
  ] ;
  rr:predicateObjectMap [
    rr:predicate rdf:type ;
    rml:objectMap [ rr:template "http://example.com/{class}" ]
  ] .

# triples map that generates "confidence" triples
<#outerTriplesMap>
  a rr:TriplesMap ;
  rml:logicalSource ex:ConfidenceSource ;
  rml:subjectMap [
    rml:quotedTriplesMap <#innerTriplesMap>
  ] ;
  rr:predicateObjectMap [
    rr:predicate ex:confidence ;
    rml:objectMap [ rml:reference "confidence"; rr:datatype xsd:float ]
  ] .
</pre>

<pre class="ex-output">
<< ex:Alice a ex:Person >> ex:confidence 0.8 .
<< ex:Bobby a ex:Dog >> ex:confidence 0.6 .
</pre>


A summary of how to generate triples in any combination of [=asserted=] and/or [=quoted triples=] is given in the following table, where `rr:TriplesMap` refers to instances of `rr:TriplesMap` that are not of the `rml:NonAssertedTriplesMap` subclass:

<nop>| Quoted | Not quoted
-|-|-
**Asserted**| `rr:TriplesMap` *with* `rml:StarMap`| `rr:TriplesMap` *without* `rml:StarMap`
**Not asserted**| `rml:NonAssertedTriplesMap` *with* `rml:StarMap`|  -

It should be noted that not quoted and not asserted triples don't generate any triple at all. For that reason, the use of `rml:NonAssertedTriplesMap` **without** `rml:StarMap` **is not allowed**. `rml:NonAssertedTriplesMap` must always be called with `rml:NonAssertedTriplesMap`.
